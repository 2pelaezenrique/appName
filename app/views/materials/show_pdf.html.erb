<% content_for :head do %>
	<%= stylesheet_link_tag 'show_video', media: "all"%>
<% end %>
<article class="article_of_pdf">
	<!-- <div class="document"> -->
	<embed src="<%= @material.file.url %>" width="500" height="375" type='<%= @material.file.instance.file_content_type %>'>

	<div class="info pdf_info">
		<div class="head_info">
			<div class="name"> <%= @material.name %></div>
			
			<div class="light">
				 <br>
					
				<div class="avatar">
					<%= link_to @material.user.avatar.url do %>
							<%= image_tag @material.user.avatar.url %>
					<% end %>
				</div>
				
				<div class="user_info">
					<%= link_to @material.user.avatar.url do %>
						<bold>
							<%= @material.user.username%>
						</bold>
						<br>
					<% end %>

					Posts: <%= Material.where(user_id: @material.user_id).count%>
				</div>
				<div class="favs"><div class="icon star favoriteAjax"></div> <number><%= @material.favorites.count %></number></div>
			<hr>	
			Publicado el <%= @material.uploadDate %>
				
			</div>
		</div>
		<div class="description pdf">
			<text>
			<%= simple_format(@material.description) %></text><br>
			<div class="light">

				<bold>Categoría: </bold><%= @material.tags.split(",")[@material.tags.split(",").length - 1] %> <br>
				<% if @material.schools.split(",").length > 1 %>
					<bold>Escuela: </bold>
					<%= @material.schools.split(",")[@material.schools.split(",").length - 2] %>: 
					<%= @material.schools.split(",")[@material.schools.split(",").length - 1] %> <br>
				<% end %>
					<bold>Autores:</bold> 
					<% @material.authors.split(",").each do |author| %>
						<%= author %>. 
					<% end %>
					<br>
				
			</div>
		</div>
		<div class="pdf_element">
			
				<%= image_tag @material.file_type + ".png" , class: "element_image"%> 
                
	             <div class="pdf_element_info">

	                <%= @material.name %> 
	                <% sizeLength = @material.file_file_size.to_s.length %>
	                <i><% if sizeLength > 6 %>
	                	<%= "(" + (@material.file_file_size/1000000).to_s + " MB)" %>
	                <% elsif sizeLength > 3 %>
	                	<%= "(" + (@material.file_file_size/1000).to_s + " KB)" %>
	                <% else %>
	                	<%= "(" + @material.file_file_size.to_s + " Bytes)" %>
	                <% end %></i>
	                <br>
                    <div class="light">
		                <% @material.authors.split(",").each do |author| %>
		                  <%= author %>
		                <% end %>
                	</div>
                	
                </div>
                <div class="element_buttons">
                	<div class="icon plus relative">
                		<div class="add_to_list">
                			<div class="triangulo_sup"></div>
                			<div class="menu_header">Añadir a:</div>
                			<ul class="all_lists">
                				<%if current_user %>
	                				<% if current_user.lists.count == 0 %>
	                					<li><%= "No tienes ninguna lista" %></li>
	                				<% else %>
	                				    <% current_user.lists.each do |list| %>
		                				    <li list-id="<%= list.id %>" class="relative	"><%= list.name %>
			                				    <% if list.materials.include?(params[:id]) %>
			                				    	<div class="icon check list_check"></div>
			                				    <% else %>
			                				    	<div class="icon check-empty list_check"></div>
			                				    <% end %>
		                				    </li>
	                				    <% end %>
	                				<% end %>
	                			<% end %>
                			</ul>
                			
                			<div class="add_list inactive_form">
								<div class="new_list_form invisible">
									<div class="triangulo_der"></div>
									<%= form_for List.new,:remote => true do |f| %>
									   <%= f.text_field :name, required: true, placeholder: "Nombre"%>
									   <%= f.text_field :description, placeholder: "Descripcion... " %>
									   <%= f.submit "Crear" %>
									<% end %>
								</div>
							</div>
                		
                		</div>
                	</div>
                	<%= link_to @material.file.url, :download => @material.file_file_name do %>
                		<div class="icon download-circle"></div>
                	<% end %>
                </div>
            
		</div>
	</div>

	
<%= render '/materials/comments.html.erb' %>
<%= render '/materials/related.html.erb' %>
</article>
<%= render '/materials/favorites_script.html.erb' %>


<!-- New List -->
<script type="text/javascript">
	$(document).ready(function  () {


		$(".add_list").on("click", function(){
			if (!$(".add_list").hasClass("active_form")) {
				setTimeout(function(){
					$(".new_list_form").removeClass("invisible");			
					$(".add_list").removeClass("inactive_form")
					$(".add_list").addClass("active_form");

				},1)
			};
		});
		
		$(".new_list_form").bind( 'clickoutside', function(event){
			if ($(".add_list").hasClass("active_form")) {
				
				$(".new_list_form").addClass("invisible");
				$(".add_list").removeClass("active_form");
				$(".add_list").addClass("inactive_form");
			};

		});
	});
</script>